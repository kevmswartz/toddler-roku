<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Roku Control</title>
    <link rel="stylesheet" href="tailwind.css">
    <style>
        body {
            -webkit-tap-highlight-color: transparent;
        }

        button {
            touch-action: manipulation;
        }

        .min-h-screen {
            min-height: 100vh;
            min-height: 100svh;
        }

        @supports (min-height: 100dvh) {
            .min-h-screen {
                min-height: 100dvh;
            }
        }

        body.fireworks-open,
        body.timer-open,
        body.youtube-player-open {
            overflow: hidden;
        }

        .showcase-highlight {
            outline: 4px solid rgba(255, 255, 255, 0.7);
            outline-offset: 4px;
            transition: outline-offset 0.2s ease, outline-color 0.2s ease;
        }

        .timer-overlay {
            backdrop-filter: blur(16px);
            background: rgba(15, 23, 42, 0.72);
        }

        .fireworks-overlay {
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(8px);
            background: rgba(15, 23, 42, 0.8);
            padding: clamp(1.5rem, 4vw, 3rem);
        }

        .fireworks-stage {
            position: absolute;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
            background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.12), rgba(15, 23, 42, 0.65));
        }

        .fireworks-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            width: 100%;
            max-width: 640px;
            margin: auto;
            padding: 2.5rem 1.5rem 3rem;
            text-align: center;
        }

        .firework-particle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 9999px;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.5);
            animation: fireworkTravel 1000ms ease-out forwards;
        }

        @keyframes fireworkTravel {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0.5);
            }

            80% {
                opacity: 1;
            }

            100% {
                opacity: 0;
                transform: translate(calc(var(--x) - 50%), calc(var(--y) - 50%)) scale(0.1);
            }
        }

        .tab-hidden {
            display: none !important;
        }

        #bottomTabNav {
            box-shadow: 0 -12px 32px rgba(15, 23, 42, 0.35);
            bottom: 0;
            padding-bottom: env(safe-area-inset-bottom, 0px);
        }

        #bottomTabNav button[data-tab-active="true"] {
            background: rgba(255, 255, 255, 0.18);
            color: #fff;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        @keyframes pulse-grow {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        @keyframes bounce-float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        @keyframes rotate-pulse {

            0%,
            100% {
                transform: rotate(0deg) scale(1);
            }

            25% {
                transform: rotate(90deg) scale(1.1);
            }

            50% {
                transform: rotate(180deg) scale(1);
            }

            75% {
                transform: rotate(270deg) scale(1.1);
            }
        }

        @keyframes wiggle {

            0%,
            100% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(-15deg);
            }

            75% {
                transform: rotate(15deg);
            }
        }

        @keyframes rainbow-glow {
            0% {
                filter: drop-shadow(0 0 20px rgba(255, 0, 0, 0.6));
            }

            33% {
                filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.6));
            }

            66% {
                filter: drop-shadow(0 0 20px rgba(0, 0, 255, 0.6));
            }

            100% {
                filter: drop-shadow(0 0 20px rgba(255, 0, 0, 0.6));
            }
        }

        .timer-emoji-btn[data-selected="true"] {
            background: rgba(255, 255, 255, 0.35);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.6);
        }

        .youtube-mode-btn[data-selected="true"] {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.5);
        }

        /* Hide scrollbars for carousel sections */
        #kidQuickSection .overflow-x-auto::-webkit-scrollbar {
            display: none;
        }

        /* Snap scrolling for carousel items */
        #toddlerQuickColumn>button {
            scroll-snap-align: start;
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-indigo-500 via-indigo-600 to-purple-700 text-white">
    <!-- Settings Lock Button -->
    <button id="settingsLock"
        class="fixed left-5 top-5 z-30 flex h-16 w-16 items-center justify-center rounded-full bg-white/10 text-2xl shadow-lg backdrop-blur transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/60 select-none"
        style="user-select: none; -webkit-user-select: none; -moz-user-select: none;" onmousedown="startSettingsHold()"
        onmouseup="stopSettingsHold()" onmouseleave="stopSettingsHold()" ontouchstart="startSettingsHold()"
        ontouchend="stopSettingsHold()" onclick="handleSettingsClick(event)">
        <svg class="absolute inset-0 h-full w-full -rotate-90 pointer-events-none" aria-hidden="true">
            <circle id="progressCircle" cx="32" cy="32" r="26" stroke="#c4b5fd" stroke-width="4" stroke-dasharray="163"
                stroke-dashoffset="163" fill="none"></circle>
        </svg>
        <span class="relative pointer-events-none">‚öôÔ∏è</span>
    </button>

    <button
        class="fixed right-5 top-5 z-50 flex h-12 w-12 items-center justify-center rounded-full bg-white/10 text-xl shadow-lg backdrop-blur transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/60"
        onclick="toggleTheme()" aria-label="Toggle theme">
        üåì
    </button>

    <!-- PIN Modal -->
    <div id="pinModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/70 backdrop-blur">
        <div class="w-[90%] max-w-xs rounded-3xl bg-white p-6 text-center text-slate-900 shadow-2xl">
            <h2 class="text-xl font-semibold text-indigo-600">Enter Grown-up PIN</h2>
            <p class="mt-1 text-sm text-slate-500">Hold the gear button, then type the code.</p>
            <div id="pinDisplay"
                class="mx-auto mt-4 flex h-12 w-full max-w-[220px] items-center justify-center gap-3 rounded-full bg-indigo-50 text-2xl font-semibold tracking-[0.65em] text-indigo-600">
                ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
            <div class="mt-6 grid grid-cols-3 gap-3">
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('1')">1</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('2')">2</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('3')">3</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('4')">4</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('5')">5</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('6')">6</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('7')">7</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('8')">8</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('9')">9</button>
                <button
                    class="col-span-3 rounded-2xl bg-indigo-200 py-3 text-sm font-semibold uppercase tracking-wide text-indigo-700 transition hover:bg-indigo-300 active:scale-95"
                    onclick="clearPin()">Clear</button>
                <button
                    class="rounded-2xl bg-indigo-100 py-4 text-xl font-bold text-indigo-700 shadow-inner transition hover:bg-indigo-200 active:scale-95"
                    onclick="enterPin('0')">0</button>
                <button
                    class="rounded-2xl bg-slate-200 py-4 text-base font-semibold text-slate-700 shadow-inner transition hover:bg-slate-300 active:scale-95"
                    onclick="closePinModal()">Cancel</button>
            </div>
        </div>
    </div>

    <main class="mx-auto flex min-h-screen w-full flex-col gap-6 px-4 pb-32 pt-20 sm:gap-8 md:px-8 md:pt-24 lg:px-12">
        <div id="statusMessage" class="status-message hidden"></div>
        <div id="advancedSettingsBanner" data-settings
            class="hidden flex flex-wrap items-center justify-between gap-3 rounded-3xl bg-white/15 px-5 py-4 text-sm font-semibold text-white shadow-2xl backdrop-blur md:px-6">
            <span>Advanced controls are unlocked. Make your changes, then tuck them away when you‚Äôre done.</span>
            <button
                class="rounded-2xl bg-white/20 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white shadow-md transition hover:bg-white/30 focus:outline-none focus:ring-2 focus:ring-white/50"
                onclick="hideSettings()">
                Hide Advanced Controls
            </button>
        </div>

        <section id="connectionSection" data-settings
            class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8">
            <div class="flex items-start justify-between gap-6">
                <div>
                    <h1 class="text-3xl font-extrabold tracking-tight text-white md:text-4xl">üéÆ Roku Playground</h1>
                    <p class="mt-2 max-w-xl text-lg text-indigo-100">Big friendly buttons for tiny humans. Advanced
                        tools stay tucked away until a grown-up unlocks them.</p>
                </div>
            </div>

            <div class="mt-8 grid gap-6 md:grid-cols-[3fr,2fr] md:items-end">
                <label class="flex flex-col gap-3">
                    <span class="text-sm font-semibold uppercase tracking-wide text-indigo-200">Roku IP Address</span>
                    <input id="rokuIp" type="text" inputmode="decimal" placeholder="192.168.1.100"
                        class="w-full rounded-2xl border border-white/20 bg-white/15 px-5 py-4 text-lg font-semibold text-white placeholder:text-indigo-200/50 shadow-inner focus:border-white/50 focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/50" />
                </label>
                <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-end">
                    <button onclick="saveIp()"
                        class="rounded-2xl bg-white/20 px-6 py-4 text-base font-semibold text-white shadow-lg transition hover:bg-white/30 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        Save IP
                    </button>
                    <button onclick="checkStatus()"
                        class="rounded-2xl bg-white px-6 py-4 text-lg font-bold text-indigo-600 shadow-xl transition hover:scale-[1.02] hover:bg-indigo-50 focus:outline-none focus:ring-4 focus:ring-white/40">
                        Connect &amp; Load Roku
                    </button>
                </div>
            </div>
            <div id="deviceInfo" class="mt-4 hidden rounded-2xl bg-white/10 px-5 py-4 text-sm text-indigo-100"></div>
        </section>



        <section id="youtubeSettingsSection" data-settings
            class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8">
            <div class="flex flex-wrap items-start justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">YouTube Playback</h2>
                    <p class="mt-1 text-sm text-indigo-100">Choose where YouTube videos should play.</p>
                </div>
            </div>

            <div class="mt-6 grid gap-4 md:grid-cols-2">
                <button id="youtubePlayRoku" onclick="setYoutubePlaybackMode('roku')"
                    class="youtube-mode-btn flex flex-col gap-3 rounded-3xl bg-white/10 p-5 text-left transition hover:bg-white/15 focus:outline-none focus:ring-2 focus:ring-white/40">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">üì∫</span>
                        <h3 class="text-lg font-bold text-white">Play on Roku</h3>
                    </div>
                    <p class="text-sm text-indigo-100">Launch videos on your Roku TV using the YouTube app.</p>
                </button>
                <button id="youtubePlayApp" onclick="setYoutubePlaybackMode('app')"
                    class="youtube-mode-btn flex flex-col gap-3 rounded-3xl bg-white/10 p-5 text-left transition hover:bg-white/15 focus:outline-none focus:ring-2 focus:ring-white/40">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">üì±</span>
                        <h3 class="text-lg font-bold text-white">Play in App</h3>
                    </div>
                    <p class="text-sm text-indigo-100">Watch videos directly in this app (great for tablets and phones).
                    </p>
                </button>
            </div>
        </section>

        <section id="tabConfigSection" data-settings
            class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8">
            <div class="flex flex-wrap items-start justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Tab Configuration</h2>
                    <p class="mt-1 text-sm text-indigo-100">Customize which tabs appear and what sections they contain.
                    </p>
                </div>
            </div>

            <div class="mt-6 space-y-4">
                <div class="rounded-2xl bg-white/10 p-4">
                    <h3 class="text-sm font-semibold uppercase tracking-wide text-indigo-200 mb-3">Current Tabs</h3>
                    <div id="tabConfigList" class="grid gap-3 sm:grid-cols-2"></div>
                </div>

                <div class="rounded-2xl bg-white/10 px-4 py-3 text-xs text-indigo-100">
                    <p class="font-semibold text-white mb-2">To customize tabs and buttons:</p>
                    <ol class="list-decimal list-inside space-y-1 ml-2">
                        <li>Edit <code
                                class="font-mono text-[11px] bg-white/10 px-1 py-0.5 rounded">public/config/app-config.json</code>
                        </li>
                        <li>Each tab has a <code
                                class="font-mono text-[11px] bg-white/10 px-1 py-0.5 rounded">buttons</code> array with
                            all its buttons</li>
                        <li>Add/remove/edit buttons directly in the tab's buttons array</li>
                        <li>The apps tab also has a <code
                                class="font-mono text-[11px] bg-white/10 px-1 py-0.5 rounded">quickLaunch</code> array
                            for YouTube videos</li>
                        <li>Refresh the page to see changes</li>
                    </ol>
                </div>
            </div>
        </section>

        <section id="contentSourceSection" data-settings
            class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8">
            <div class="flex flex-wrap items-start justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Kid Button Cloud Config</h2>
                    <p class="mt-1 text-sm text-indigo-100">Set your personal passphrase to load custom button layouts
                        from the cloud.</p>
                </div>
            </div>

            <div class="mt-6 grid gap-4 md:grid-cols-[2fr,1fr] md:items-start">
                <label class="flex flex-col gap-3">
                    <span class="text-sm font-semibold uppercase tracking-wide text-indigo-200">Config Passphrase</span>
                    <input id="toddlerContentPassphrase" type="text" inputmode="text"
                        placeholder="blue mountain coffee morning sunshine"
                        class="w-full rounded-2xl border border-white/20 bg-white/15 px-5 py-4 text-sm font-semibold text-white placeholder:text-indigo-200/50 shadow-inner focus:border-white/50 focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/50" />
                    <span class="text-xs text-indigo-200/70">Enter at least 5 words separated by spaces. Each unique
                        passphrase stores a separate configuration.</span>
                </label>
                <div class="flex flex-col gap-3 md:items-end">
                    <button onclick="saveToddlerContentPassphrase()"
                        class="rounded-2xl bg-white/20 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:bg-white/30 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        Save Passphrase
                    </button>
                    <button onclick="refreshToddlerContent()"
                        class="rounded-2xl bg-white/15 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:bg-white/25 focus:outline-none focus:ring-2 focus:ring-white/40">
                        Refresh from Cloud
                    </button>
                    <button onclick="clearToddlerContentPassphrase()"
                        class="rounded-2xl bg-rose-500/30 px-5 py-3 text-sm font-semibold text-rose-50 shadow-lg transition hover:bg-rose-500/40 focus:outline-none focus:ring-2 focus:ring-rose-200/60">
                        Clear Passphrase
                    </button>
                </div>
            </div>
            <p id="toddlerContentCacheInfo" class="mt-4 rounded-2xl bg-white/10 px-4 py-3 text-xs text-indigo-100"></p>

            <!-- Cloud Config Editor -->
            <div id="cloudConfigEditor" class="mt-6 hidden space-y-4">
                <div class="rounded-3xl bg-white/10 p-6 space-y-4">
                    <div>
                        <h3 class="text-lg font-bold text-white">Edit & Save Cloud Config</h3>
                        <p class="mt-1 text-xs text-indigo-100/80">Make changes to your button layout and save it to the
                            cloud with your passphrase.</p>
                    </div>
                    <div class="space-y-3">
                        <label class="flex flex-col gap-2">
                            <span class="text-xs font-semibold uppercase tracking-wide text-indigo-200">Configuration
                                JSON</span>
                            <textarea id="cloudConfigJson" rows="12" spellcheck="false"
                                class="w-full rounded-2xl border border-white/20 bg-black/30 px-4 py-3 font-mono text-xs text-white placeholder:text-indigo-200/50 shadow-inner focus:border-white/50 focus:bg-black/40 focus:outline-none focus:ring-2 focus:ring-white/50"
                                placeholder='{"tabs": [...]}'></textarea>
                        </label>
                        <div class="flex flex-wrap gap-3">
                            <button onclick="loadCurrentConfigIntoEditor()"
                                class="rounded-2xl bg-white/15 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:bg-white/25 focus:outline-none focus:ring-2 focus:ring-white/40">
                                Load Current Config
                            </button>
                            <button onclick="saveConfigToCloud()"
                                class="rounded-2xl bg-emerald-500/30 px-5 py-3 text-sm font-semibold text-emerald-50 shadow-lg transition hover:bg-emerald-500/40 focus:outline-none focus:ring-2 focus:ring-emerald-200/60">
                                üíæ Save to Cloud
                            </button>
                            <button onclick="validateConfigJson()"
                                class="rounded-2xl bg-white/15 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:bg-white/25 focus:outline-none focus:ring-2 focus:ring-white/40">
                                Validate JSON
                            </button>
                        </div>
                        <p class="text-xs text-indigo-100/70">Tip: Click "Load Current Config" to see what's currently
                            loaded, make your edits, then "Save to Cloud".</p>
                    </div>
                </div>
            </div>

            <div class="mt-4 rounded-2xl bg-white/10 px-4 py-3 text-xs text-indigo-100">
                Bundled configuration lives in <code
                    class="font-mono text-[11px] text-white">config/app-config.json</code>. Add <code
                    class="font-mono text-[11px] text-white">app-config.custom.json</code> beside it for local
                tweaks‚ÄîGit will ignore that file.
            </div>
            <div id="buttonHandlerCatalog"
                class="mt-6 hidden space-y-4 rounded-3xl bg-white/10 p-4 text-indigo-100 shadow-inner">
                <div>
                    <h3 class="text-base font-semibold text-white">Kid-mode Handler Catalog</h3>
                    <p class="mt-1 text-xs text-indigo-100/80">Use these button types and handlers when editing your
                        config files.</p>
                </div>
                <div id="buttonHandlerList" class="grid gap-3 md:grid-cols-2 xl:grid-cols-3"></div>
                <div>
                    <h4 class="text-sm font-semibold text-white/90">Content Providers</h4>
                    <div id="contentProviderList" class="mt-2 grid gap-2 text-xs text-indigo-100"></div>
                </div>
            </div>
        </section>



        <section id="parentalControlsSection" data-settings
            class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8">
            <div class="flex flex-wrap items-start justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Parental Controls</h2>
                    <p class="mt-1 text-sm text-indigo-100 max-w-2xl">Update the 4-digit PIN that unlocks these
                        settings. This override is stored on this device; cloud configs can also provide a PIN.</p>
                </div>
            </div>

            <div class="mt-6 grid gap-4 md:grid-cols-[minmax(0,3fr)_minmax(0,2fr)]">
                <div class="space-y-3">
                    <label class="text-xs font-semibold uppercase tracking-wide text-indigo-200"
                        for="parentalPinInput">New PIN</label>
                    <input id="parentalPinInput" type="password" inputmode="numeric" maxlength="4" pattern="[0-9]*"
                        class="w-full rounded-2xl border border-white/20 bg-black/30 px-4 py-3 text-white placeholder:text-indigo-200/50 focus:border-white/50 focus:bg-black/40 focus:outline-none focus:ring-2 focus:ring-white/40"
                        placeholder="1234">
                    <p id="parentalPinStatus" class="text-xs text-indigo-100/80">PIN status loading‚Ä¶</p>
                </div>

                <div class="flex flex-wrap gap-3">
                    <button onclick="saveParentalPinOverride()"
                        class="rounded-2xl bg-white/20 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:bg-white/30 focus:outline-none focus:ring-2 focus:ring-white/40">
                        Save PIN
                    </button>
                    <button onclick="clearParentalPinOverride()"
                        class="rounded-2xl bg-white/10 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30">
                        Reset to Cloud
                        <div id="toddlerQuickColumn" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
        </section>

        <section id="toddlerControls" class="rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8">
            <div id="toddlerRemoteColumn" class="flex flex-col gap-4"></div>
        </section>



        <section id="nowPlayingSection" class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8"
            data-settings>
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Now Playing</h2>
                    <p class="mt-1 text-sm text-indigo-100">Live info from the Roku media player.</p>
                </div>
                <div class="flex flex-wrap gap-3">
                    <button onclick="checkNowPlaying()"
                        class="rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/20">Refresh</button>
                    <button onclick="showFullMediaInfo()"
                        class="rounded-2xl bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/20">Show
                        XML</button>
                </div>
            </div>
            <div id="nowPlayingInfo" class="mt-4 rounded-2xl bg-white/10 px-5 py-4 text-sm text-indigo-50"></div>
            <pre id="fullMediaInfo"
                class="mt-4 hidden max-h-80 overflow-auto rounded-2xl bg-slate-950/70 px-5 py-4 text-xs text-indigo-100"></pre>
        </section>

        <section id="appsSection" class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8"
            data-settings>
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Installed Apps</h2>
                    <p class="mt-1 text-sm text-indigo-100">Tap to launch, even if Roku hides the full list.</p>
                </div>
            </div>
            <div id="appsList" class="mt-6 grid gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"></div>
        </section>

        <section id="quickLaunchSection" class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8"
            data-settings>
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Quick Launch</h2>
                    <p class="mt-1 text-sm text-indigo-100">Favorite shows with one tap.</p>
                </div>
            </div>
            <div id="quickLaunchGrid" class="mt-6 grid gap-4 min-[480px]:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
            </div>
        </section>

        <section id="deepLinkSection" class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8"
            data-settings>
            <h2 class="text-2xl font-bold text-white">Deep Link Toolkit</h2>
            <p class="mt-1 text-sm text-indigo-100">Launch straight into hidden screens or playback positions.</p>

            <div class="mt-6 grid gap-4 rounded-3xl bg-slate-950/40 p-5">
                <input id="deepLinkAppId" type="text"
                    class="rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-indigo-100/50 focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30"
                    placeholder="App ID (e.g. 12 for Netflix)" />
                <input id="deepLinkContentId" type="text"
                    class="rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-indigo-100/50 focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30"
                    placeholder="Params (mediaType=movie&contentId=80014749)" />
                <button onclick="launchDeepLink()"
                    class="rounded-2xl bg-white px-5 py-3 text-base font-semibold text-indigo-600 shadow-lg transition hover:bg-indigo-50">Launch
                    Deep Link</button>
            </div>

            <details class="mt-4 rounded-2xl bg-white/10 p-4 text-sm text-indigo-50">
                <summary class="cursor-pointer text-base font-semibold text-white">Deep Link Examples</summary>
                <div class="mt-2 space-y-3 text-xs leading-relaxed">
                    <p><strong>Netflix (ID 12)</strong> ‚Äî movie: <code>mediaType=movie&amp;contentId=80014749</code>,
                        series: <code>mediaType=series&amp;contentId=80057281</code></p>
                    <p><strong>YouTube (ID 837)</strong> ‚Äî <code>contentId=dQw4w9WgXcQ</code></p>
                    <p><strong>Hulu (ID 2213)</strong> ‚Äî <code>contentId=series/some-show-id</code></p>
                    <p><strong>Plex (ID 151908)</strong> ‚Äî <code>contentId=/library/metadata/12345</code></p>
                    <p><strong>Disney+ (ID 291097)</strong> ‚Äî try <code>contentId=SERIES_ID</code>,
                        <code>seriesId=XXX</code>, <code>videoId=XXX</code>, <code>programId=XXX</code>
                    </p>
                </div>
            </details>

            <details class="mt-4 rounded-2xl bg-white/10 p-4 text-sm text-indigo-50">
                <summary class="cursor-pointer text-base font-semibold text-white">YouTube Launcher</summary>
                <div class="mt-3 space-y-3">
                    <p>Paste a YouTube URL to open it on Roku:</p>
                    <input id="youtubeUrl" type="text"
                        class="w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-indigo-100/50 focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30"
                        placeholder="https://www.youtube.com/watch?v=OBqZDyVlFP8" />
                    <button onclick="launchYouTube()"
                        class="w-full rounded-2xl bg-white px-5 py-3 text-base font-semibold text-indigo-600 shadow-lg transition hover:bg-indigo-50">Launch
                        on Roku</button>
                    <div id="youtubeResult" class="hidden rounded-2xl bg-slate-950/60 px-4 py-3 text-xs"></div>
                </div>
            </details>

            <details class="mt-4 rounded-2xl bg-white/10 p-4 text-sm text-indigo-50">
                <summary class="cursor-pointer text-base font-semibold text-white">Disney+ ID Finder</summary>
                <div class="mt-3 space-y-3">
                    <p>Paste a Disney+ URL to grab the content ID:</p>
                    <input id="disneyUrl" type="text"
                        class="w-full rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-indigo-100/50 focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30"
                        placeholder="https://www.disneyplus.com/series/the-mandalorian/3jLIGMDYINqD" />
                    <button onclick="extractDisneyId()"
                        class="w-full rounded-2xl bg-white/20 px-5 py-3 text-base font-semibold text-white shadow-lg transition hover:bg-white/30">Extract
                        ID</button>
                    <div id="disneyIdResult" class="hidden rounded-2xl bg-slate-950/60 px-4 py-3 text-xs"></div>
                </div>
            </details>
        </section>

        <section id="remoteSection" class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8"
            data-settings>
            <h2 class="text-2xl font-bold text-white">Advanced Remote</h2>
            <p class="mt-1 text-sm text-indigo-100">All the classic Roku controls laid out for quick access.</p>
            <div class="mt-6 grid grid-cols-3 gap-3 text-base sm:text-lg font-semibold">
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Back')">‚¨ÖÔ∏è Back</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Home')">üè† Home</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Info')">‚ÑπÔ∏è Info</button>

                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Rev')">‚èÆÔ∏è Rev</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Play')">‚èØÔ∏è Play</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Fwd')">‚è≠Ô∏è Fwd</button>

                <div></div>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Up')">‚¨ÜÔ∏è</button>
                <div></div>

                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Left')">‚¨ÖÔ∏è</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Select')">‚≠ï OK</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Right')">‚û°Ô∏è</button>

                <div></div>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('Down')">‚¨áÔ∏è</button>
                <div></div>

                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('InstantReplay')">‚è™ Replay</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('VolumeUp')">üîä Vol+</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('VolumeMute')">üîá Mute</button>

                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('PowerOff')">üîò Power</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('VolumeDown')">üîâ Vol-</button>
                <button
                    class="remote-btn rounded-2xl bg-white/10 px-4 py-4 sm:px-5 sm:py-5 text-white shadow-inner transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40 active:scale-95 touch-manipulation"
                    onclick="sendKey('ChannelUp')">‚¨ÜÔ∏è CH+</button>
            </div>
        </section>

        <section id="macroSection" class="hidden rounded-3xl bg-white/15 p-6 shadow-2xl backdrop-blur md:p-8"
            data-settings>
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">Macro Magic</h2>
                    <p class="mt-1 text-sm text-indigo-100">Create sequences to launch apps, wait, and press buttons
                        automatically.</p>
                </div>
                <button onclick="openMacroHelp()"
                    class="rounded-full bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/20">How
                    it works</button>
            </div>

            <div class="mt-6 grid gap-6 lg:grid-cols-[2fr,3fr]">
                <form id="macroForm" class="grid gap-4 rounded-3xl bg-slate-950/40 p-5">
                    <label class="grid gap-2 text-sm font-semibold uppercase tracking-wide text-indigo-200">
                        Macro Name
                        <input id="macroName" type="text"
                            class="rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-indigo-100/50 focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30"
                            placeholder="Bedtime Routine" required />
                    </label>

                    <label class="grid gap-2 text-sm font-semibold uppercase tracking-wide text-indigo-200">
                        Steps
                        <div
                            class="rounded-2xl border border-dashed border-white/20 bg-white/5 px-4 py-4 text-sm text-indigo-100">
                            <p class="text-xs uppercase tracking-wide text-indigo-200/80">Add step</p>
                            <div class="mt-3 flex flex-col gap-3 sm:flex-row">
                                <select id="macroActionType"
                                    class="flex-1 rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30">
                                    <option value="key">Press Remote Key</option>
                                    <option value="launch">Launch App</option>
                                    <option value="delay">Wait</option>
                                </select>
                                <input id="macroActionValue" type="text"
                                    class="flex-1 rounded-2xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-indigo-100/50 focus:border-white/40 focus:outline-none focus:ring-2 focus:ring-white/30"
                                    placeholder="Key (Home) / App ID (12) / Milliseconds (1000)" />
                                <button type="button" onclick="addMacroStep()"
                                    class="rounded-2xl bg-white px-5 py-3 text-base font-semibold text-indigo-600 shadow-lg transition hover:bg-indigo-50">Add
                                    Step</button>
                            </div>
                        </div>
                    </label>

                    <ul id="macroStepsPreview"
                        class="min-h-[80px] space-y-3 rounded-2xl bg-indigo-950/30 p-4 text-sm text-indigo-100"></ul>

                    <div class="flex flex-col gap-3 sm:flex-row sm:justify-between">
                        <label class="flex items-center gap-2 text-sm text-indigo-100">
                            <input id="macroMarkFavorite" type="checkbox"
                                class="h-4 w-4 rounded border-white/40 bg-white/10 text-indigo-500 focus:ring-white/40" />
                            Show in kid mode as the Magic Button
                        </label>
                        <button type="submit"
                            class="rounded-2xl bg-primary px-6 py-3 text-base font-bold text-white shadow-lg transition hover:bg-primary-dark">Save
                            Macro</button>
                    </div>
                </form>

                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-white">Saved Macros</h3>
                    <div id="macroList" class="grid gap-3"></div>
                </div>
            </div>
        </section>
        <div id="toastContainer"
            class="pointer-events-none fixed left-1/2 top-6 z-50 hidden -translate-x-1/2 transform">
        </div>





        <div id="youtubePlayerOverlay"
            class="fixed inset-0 z-50 hidden items-center justify-center bg-black/95 px-4 py-6">
            <div class="relative w-full max-w-6xl">
                <button onclick="closeYoutubePlayer()"
                    class="absolute -top-12 right-0 rounded-full bg-white/10 px-4 py-2 text-sm font-semibold uppercase tracking-wide text-white transition hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/40">
                    Close Video
                </button>
                <div class="relative w-full pt-[56.25%]">
                    <iframe id="youtubePlayerFrame" class="absolute inset-0 h-full w-full rounded-2xl" src=""
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>

        <script src="modules.js"></script>

        <script src="app.js"></script>
</body>

</html>